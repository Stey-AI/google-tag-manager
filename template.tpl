___TERMS_OF_SERVICE___

By creating or modifying this file you agree to Google Tag Manager's Community
Template Gallery Developer Terms of Service available at
https://developers.google.com/tag-manager/gallery-tos (or such other URL as
Google may provide), as modified from time to time.


___INFO___

{
  "type": "TAG",
  "id": "cvt_temp_public_id",
  "version": 1,
  "securityGroups": [],
  "displayName": "Stey",
  "categories": ["EXPERIMENTATION", "ANALYTICS", "CONVERSIONS"],
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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\u003d\u003d"
  },
  "description": "Stey is a revolutionary tool designed for small and medium-sized e-commerce sites and SaaS companies to increase the conversion rate of your website.",
  "containerContexts": [
    "WEB"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "TEXT",
    "name": "apiKey",
    "displayName": "API Key",
    "simpleValueType": true,
    "alwaysInSummary": true,
    "help": "You can copy the API Key from your Stey project\u0027s [Settings Page]",
    "notSetText": "Please enter the API Key"
  }
]


___SANDBOXED_JS_FOR_WEB_TEMPLATE___

const logToConsole = require('logToConsole');
const injectScript = require('injectScript');
const queryPermission = require('queryPermission');
const callInWindow = require('callInWindow');
// const setInWindow = require('setInWindow');

const defaultHostname = 'static.stey.ai';


logToConsole('data =', data);

const log = (message) => {
  logToConsole('Stey (GTM):', message);
};


// const hostname = data.customDomain && data.customDomainToggle ? data.customDomain : defaultHostname;
const hostname = defaultHostname;

const url = 'https://' + hostname;
const latestScript = url + '/sdk/web/latest/index.js';

const apiKey = data.apiKey;
const options = [];


//If the script loads, log a message and run gtmOnSuccess
const onSuccess = () => {
  log('Stey Script Loaded');
  log(apiKey);
  log(options);
  callInWindow('steyAIRecord.initialize', apiKey);
  data.gtmOnSuccess();
};
// If the script fails, log a message and run gtmOnFailure
const onFailure = () => {
  log('Stey Script Load Failed ');
  data.gtmOnFailure();
};

  
// Check if have permission to use the custom domain
if (queryPermission('inject_script', latestScript)) {

  // Inject latest script
  log(latestScript);
  injectScript(latestScript, onSuccess, onFailure);

} else {
  if (hostname !== defaultHostname) {
    log('You need to add "https://' + hostname + '/*" to "Inject scripts" in the "Permissions" tab of Google Tab Manager');
  } else {
    log('No permission to load default script (' + latestScript + '). Check the "Inject scripts" in the "Permissions" tab of Google Tab Manager.');
  }
  data.gtmOnFailure();
}


___WEB_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "logging",
        "versionId": "1"
      },
      "param": [
        {
          "key": "environments",
          "value": {
            "type": 1,
            "string": "debug"
          }
        }
      ]
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_globals",
        "versionId": "1"
      },
      "param": []
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "inject_script",
        "versionId": "1"
      },
      "param": [
        {
          "key": "urls",
          "value": {
            "type": 2,
            "listItem": [
              {
                "type": 1,
                "string": "https://static.stey.ai/*"
              }
            ]
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []


___NOTES___

Created on 2/6/2024, 12:19:29 PM


